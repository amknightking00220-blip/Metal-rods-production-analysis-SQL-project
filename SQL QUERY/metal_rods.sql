create table metal_rods (
 BatchID int	,
 Operator nvarchar(70),
 Machine nvarchar(70),
 Shift_ nvarchar(70)	,
 Diameter_mm decimal(10,8),
 Defective int ,
 );

 insert  into metal_rods (BatchID ,	Operator	,Machine	,Shift_	,Diameter_mm,	Defective) values

 (1, 'C', 'M1', 'Night', 10.11, 1),
(1, 'C', 'M1', 'Night', 10.11, 0),
(1, 'C', 'M1', 'Night', 10.15, 0),
(1, 'C', 'M1', 'Night', 10.09, 1),
(1, 'C', 'M1', 'Night', 10.12, 1),
(2, 'B', 'M1', 'Afternoon', 10.15, 0),
(2, 'B', 'M1', 'Afternoon', 10.15, 1),
(2, 'B', 'M1', 'Afternoon', 10.15, 1),
(2, 'B', 'M1', 'Afternoon', 10.15, 1),
(2, 'B', 'M1', 'Afternoon', 10.15, 0),
(3, 'C', 'M2', 'Afternoon', 10.15, 0),
(3, 'C', 'M2', 'Afternoon', 10.15, 1),
(3, 'C', 'M2', 'Afternoon', 10.15, 0),
(3, 'C', 'M2', 'Afternoon', 10.15, 0),
(3, 'C', 'M2', 'Afternoon', 10.15, 0),
(4, 'A', 'M1', 'Night', 9.991987678, 0),
(4, 'A', 'M1', 'Night', 9.985183058, 0),
(4, 'A', 'M1', 'Night', 9.947577251, 1),
(4, 'A', 'M1', 'Night', 9.99220377, 0),
(4, 'A', 'M1', 'Night', 9.977061584, 0),
(5, 'C', 'M2', 'Morning', 9.987921301, 0),
(5, 'C', 'M2', 'Morning', 10.01651545, 0),
(5, 'C', 'M2', 'Morning', 9.973144771, 0),
(5, 'C', 'M2', 'Morning', 9.985774453, 0),
(5, 'C', 'M2', 'Morning', 10.0162754, 0),
(6, 'C', 'M2', 'Afternoon', 9.946447058, 1),
(6, 'C', 'M2', 'Afternoon', 9.97077886, 0),
(6, 'C', 'M2', 'Afternoon', 9.973808962, 0),
(6, 'C', 'M2', 'Afternoon', 9.982242177, 0),
(6, 'C', 'M2', 'Afternoon', 9.930593322, 1),
(7, 'A', 'M2', 'Morning', 9.963425286, 1),
(7, 'A', 'M2', 'Morning', 9.968609395, 1),
(7, 'A', 'M2', 'Morning', 9.998964615, 0),
(7, 'A', 'M2', 'Morning', 9.984694536, 0),
(7, 'A', 'M2', 'Morning', 9.942561367, 1),
(8, 'A', 'M1', 'Night', 9.944529206, 1),
(8, 'A', 'M1', 'Night', 9.984590951, 0),
(8, 'A', 'M1', 'Night', 9.953730435, 1),
(8, 'A', 'M1', 'Night', 9.9813857, 0),
(8, 'A', 'M1', 'Night', 9.997938074, 0),
(9, 'B', 'M3', 'Afternoon', 9.99937064, 0),
(9, 'B', 'M3', 'Afternoon', 9.973823058, 0),
(9, 'B', 'M3', 'Afternoon', 9.969170034, 1),
(9, 'B', 'M3', 'Afternoon', 10.00097203, 0),
(9, 'B', 'M3', 'Afternoon', 9.959413542, 1),
(10, 'B', 'M3', 'Night', 9.982916477, 0),
(10, 'B', 'M3', 'Night', 10.00389182, 0),
(10, 'B', 'M3', 'Night', 10.00034446, 0),
(10, 'B', 'M3', 'Night', 10.01434124, 0),
(10, 'B', 'M3', 'Night', 9.991196177, 0),
(11, 'C', 'M3', 'Morning', 9.997434712, 0),
(11, 'C', 'M3', 'Morning', 9.963162523, 1),
(11, 'C', 'M3', 'Morning', 9.985160738, 0),
(11, 'C', 'M3', 'Morning', 9.989580518, 0),
(11, 'C', 'M3', 'Morning', 10.01000034, 0),
(12, 'A', 'M2', 'Morning', 9.962082676, 1),
(12, 'A', 'M2', 'Morning', 9.976198587, 0),
(12, 'A', 'M2', 'Morning', 10.00685798, 0),
(12, 'A', 'M2', 'Morning', 9.987740525, 0),
(12, 'A', 'M2', 'Morning', 9.983446377, 0),
(13, 'B', 'M2', 'Afternoon', 10.03068546, 1),
(13, 'B', 'M2', 'Afternoon', 10.01266406, 0),
(13, 'B', 'M2', 'Afternoon', 10.01381198, 0),
(13, 'B', 'M2', 'Afternoon', 10.03495897, 1),
(13, 'B', 'M2', 'Afternoon', 10.01103279, 0),
(14, 'A', 'M3', 'Afternoon', 9.988794033, 0),
(14, 'A', 'M3', 'Afternoon', 10.02162522, 0),
(14, 'A', 'M3', 'Afternoon', 9.990311494, 0),
(14, 'A', 'M3', 'Afternoon', 9.943047026, 1),
(14, 'A', 'M3', 'Afternoon', 10.00306091, 0),
(15, 'A', 'M1', 'Night', 9.970048109, 0),
(15, 'A', 'M1', 'Night', 9.976732738, 0),
(15, 'A', 'M1', 'Night', 9.974998625, 0),
(15, 'A', 'M1', 'Night', 9.944563198, 1),
(15, 'A', 'M1', 'Night', 10.01167, 0),
(16, 'B', 'M1', 'Afternoon', 9.970688154, 0),
(16, 'B', 'M1', 'Afternoon', 9.972423036, 0),
(16, 'B', 'M1', 'Afternoon', 10.02048327, 0),
(16, 'B', 'M1', 'Afternoon', 9.967371212, 1),
(16, 'B', 'M1', 'Afternoon', 9.977249379, 0),
(17, 'B', 'M1', 'Afternoon', 10.032181, 1),
(17, 'B', 'M1', 'Afternoon', 10.03296298, 1),
(17, 'B', 'M1', 'Afternoon', 9.998954593, 0),
(17, 'B', 'M1', 'Afternoon', 10.04519823, 1),
(17, 'B', 'M1', 'Afternoon', 9.989105321, 0),
(18, 'B', 'M2', 'Night', 10.01855613, 0),
(18, 'B', 'M2', 'Night', 10.00824835, 0),
(18, 'B', 'M2', 'Night', 9.983744615, 0),
(18, 'B', 'M2', 'Night', 10.02347981, 0),
(18, 'B', 'M2', 'Night', 10.01631615, 0),
(19, 'C', 'M3', 'Afternoon', 9.978111308, 0),
(19, 'C', 'M3', 'Afternoon', 9.955493974, 1),
(19, 'C', 'M3', 'Afternoon', 9.986211897, 0),
(19, 'C', 'M3', 'Afternoon', 9.958351564, 1),
(19, 'C', 'M3', 'Afternoon', 10.00773874, 0),
(20, 'B', 'M1', 'Night', 9.98180997, 0),
(20, 'B', 'M1', 'Night', 10.00452154, 0),
(20, 'B', 'M1', 'Night', 9.963633914, 1),
(20, 'B', 'M1', 'Night', 9.992800399, 0),
(20, 'B', 'M1', 'Night', 10.01439406, 0),
(21, 'A', 'M2', 'Morning', 10.0195347, 0),
(21, 'A', 'M2', 'Morning', 9.979159228, 0),
(21, 'A', 'M2', 'Morning', 9.97748911, 0),
(21, 'A', 'M2', 'Morning', 10.01433707, 0),
(21, 'A', 'M2', 'Morning', 10.00983794, 0),
(22, 'B', 'M1', 'Night', 10.04858184, 1),
(22, 'B', 'M1', 'Night', 10.02414785, 0),
(22, 'B', 'M1', 'Night', 10.00951996, 0),
(22, 'B', 'M1', 'Night', 10.00995015, 0),
(22, 'B', 'M1', 'Night', 9.974118563, 0),
(23, 'C', 'M1', 'Morning', 9.979543137, 0),
(23, 'C', 'M1', 'Morning', 10.00691225, 0),
(23, 'C', 'M1', 'Morning', 9.965357936, 1),
(23, 'C', 'M1', 'Morning', 9.960850996, 1),
(23, 'C', 'M1', 'Morning', 10.00214745, 0),
(24, 'C', 'M3', 'Afternoon', 9.970341078, 0),
(24, 'C', 'M3', 'Afternoon', 9.985115249, 0),
(24, 'C', 'M3', 'Afternoon', 9.993480323, 0),
(24, 'C', 'M3', 'Afternoon', 9.9921911, 0),
(24, 'C', 'M3', 'Afternoon', 10.00320095, 0),
(25, 'B', 'M1', 'Afternoon', 10.04390708, 1),
(25, 'B', 'M1', 'Afternoon', 10.01300412, 0),
(25, 'B', 'M1', 'Afternoon', 10.03053844, 1),
(25, 'B', 'M1', 'Afternoon', 10.07614526, 1),
(25, 'B', 'M1', 'Afternoon', 10.01984277, 0),
(26, 'A', 'M1', 'Afternoon', 10.01294483, 0),
(26, 'A', 'M1', 'Afternoon', 9.98908877, 0),
(26, 'A', 'M1', 'Afternoon', 10.01367901, 0),
(26, 'A', 'M1', 'Afternoon', 10.01904944, 0),
(26, 'A', 'M1', 'Afternoon', 9.99129518, 0),
(27, 'C', 'M2', 'Morning', 10.00973673, 0),
(27, 'C', 'M2', 'Morning', 10.0291472, 0),
(27, 'C', 'M2', 'Morning', 9.994840929, 0),
(27, 'C', 'M2', 'Morning', 9.990330996, 0),
(27, 'C', 'M2', 'Morning', 10.00142971, 0),
(28, 'B', 'M2', 'Afternoon', 10.03441068, 1),
(28, 'B', 'M2', 'Afternoon', 9.993906545, 0),
(28, 'B', 'M2', 'Afternoon', 10.0407268, 1),
(28, 'B', 'M2', 'Afternoon', 10.03118915, 1),
(28, 'B', 'M2', 'Afternoon', 10.00100862, 0),
(29, 'C', 'M2', 'Morning', 9.992912662, 0),
(29, 'C', 'M2', 'Morning', 9.977886835, 0),
(29, 'C', 'M2', 'Morning', 9.986451036, 0),
(29, 'C', 'M2', 'Morning', 9.957794592, 1),
(29, 'C', 'M2', 'Morning', 10.02901269, 0),
(30, 'C', 'M2', 'Night', 9.969365597, 1),
(30, 'C', 'M2', 'Night', 10.05873899, 1),
(30, 'C', 'M2', 'Night', 9.978274823, 0),
(30, 'C', 'M2', 'Night', 10.01820226, 0),
(30, 'C', 'M2', 'Night', 10.07283315, 1),
(31, 'A', 'M1', 'Morning', 10.01513126, 0),
(31, 'A', 'M1', 'Morning', 10.01066555, 0),
(31, 'A', 'M1', 'Morning', 9.992331657, 0),
(31, 'A', 'M1', 'Morning', 10.00284579, 0),
(31, 'A', 'M1', 'Morning', 10.02660225, 0),
(32, 'A', 'M2', 'Afternoon', 10.0031489, 0),
(32, 'A', 'M2', 'Afternoon', 10.00683032, 0),
(32, 'A', 'M2', 'Afternoon', 9.982337649, 0),
(32, 'A', 'M2', 'Afternoon', 10.00028391, 0),
(32, 'A', 'M2', 'Afternoon', 10.04894633, 1),
(33, 'B', 'M2', 'Morning', 9.969904989, 1),
(33, 'B', 'M2', 'Morning', 9.98044468, 0),
(33, 'B', 'M2', 'Morning', 9.988325513, 0),
(33, 'B', 'M2', 'Morning', 10.01946039, 0),
(33, 'B', 'M2', 'Morning', 9.981304546, 0),
(34, 'A', 'M2', 'Morning', 9.967524769, 1),
(34, 'A', 'M2', 'Morning', 10.00254767, 0),
(34, 'A', 'M2', 'Morning', 9.963056061, 1),
(34, 'A', 'M2', 'Morning', 9.986085839, 0),
(34, 'A', 'M2', 'Morning', 9.992702132, 0),
(35, 'B', 'M2', 'Morning', 9.978473493, 0),
(35, 'B', 'M2', 'Morning', 9.940676631, 1),
(35, 'B', 'M2', 'Morning', 9.954572006, 1),
(35, 'B', 'M2', 'Morning', 10.01143722, 0),
(35, 'B', 'M2', 'Morning', 10.00704114, 0),
(36, 'B', 'M3', 'Afternoon', 10.04783757, 1),
(36, 'B', 'M3', 'Afternoon', 10.00897714, 0),
(36, 'B', 'M3', 'Afternoon', 10.0190724, 0),
(36, 'B', 'M3', 'Afternoon', 9.996828483, 0),
(36, 'B', 'M3', 'Afternoon', 10.00209557, 0),
(37, 'C', 'M2', 'Night', 10.06466911, 1),
(37, 'C', 'M2', 'Night', 10.01481269, 0),
(37, 'C', 'M2', 'Night', 9.993257029, 0),
(37, 'C', 'M2', 'Night', 10.00614944, 0),
(37, 'C', 'M2', 'Night', 9.986975569, 0),
(38, 'B', 'M3', 'Morning', 9.996855474, 0),
(38, 'B', 'M3', 'Morning', 10.01040332, 0),
(38, 'B', 'M3', 'Morning', 9.983412914, 0),
(38, 'B', 'M3', 'Morning', 9.980258765, 0),
(38, 'B', 'M3', 'Morning', 9.985593736, 0),
(39, 'A', 'M2', 'Morning', 10.0051551, 0),
(39, 'A', 'M2', 'Morning', 9.962394509, 1),
(39, 'A', 'M2', 'Morning', 10.03452106, 1),
(39, 'A', 'M2', 'Morning', 10.04413821, 1),
(39, 'A', 'M2', 'Morning', 10.04049007, 1),
(40, 'C', 'M2', 'Morning', 10.01320071, 0),
(40, 'C', 'M2', 'Morning', 10.02101915, 0),
(40, 'C', 'M2', 'Morning', 9.981171602, 0),
(40, 'C', 'M2', 'Morning', 9.981803652, 0),
(40, 'C', 'M2', 'Morning', 9.99519442, 0),
(41, 'A', 'M1', 'Afternoon', 9.961620462, 1),
(41, 'A', 'M1', 'Afternoon', 9.951358046, 1),
(41, 'A', 'M1', 'Afternoon', 9.957185078, 1),
(41, 'A', 'M1', 'Afternoon', 9.954925291, 1),
(41, 'A', 'M1', 'Afternoon', 9.982831574, 0),
(42, 'B', 'M3', 'Night', 9.98691549, 0),
(42, 'B', 'M3', 'Night', 9.99123925, 0),
(42, 'B', 'M3', 'Night', 9.971106367, 0),
(42, 'B', 'M3', 'Night', 9.958388046, 1),
(42, 'B', 'M3', 'Night', 9.992587454, 0),
(43, 'A', 'M3', 'Morning', 10.03529666, 1),
(43, 'A', 'M3', 'Morning', 10.02900645, 0),
(43, 'A', 'M3', 'Morning', 10.02885961, 0),
(43, 'A', 'M3', 'Morning', 10.02203664, 0),
(43, 'A', 'M3', 'Morning', 10.05087465, 1),
(44, 'B', 'M1', 'Afternoon', 9.977855371, 0),
(44, 'B', 'M1', 'Afternoon', 9.99748904, 0),
(44, 'B', 'M1', 'Afternoon', 9.981024896, 0),
(44, 'B', 'M1', 'Afternoon', 9.969927815, 1),
(44, 'B', 'M1', 'Afternoon', 9.985444017, 0),
(45, 'C', 'M1', 'Morning', 10.01723882, 0),
(45, 'C', 'M1', 'Morning', 9.94929507, 1),
(45, 'C', 'M1', 'Morning', 10.02143723, 0),
(45, 'C', 'M1', 'Morning', 9.983990104, 0),
(45, 'C', 'M1', 'Morning', 9.989945332, 0),
(46, 'B', 'M2', 'Morning', 10.02298386, 0),
(46, 'B', 'M2', 'Morning', 9.986235956, 0),
(46, 'B', 'M2', 'Morning', 10.02355183, 0),
(46, 'B', 'M2', 'Morning', 9.997335228, 0),
(46, 'B', 'M2', 'Morning', 9.959136525, 1),
(47, 'A', 'M1', 'Afternoon', 10.01465532, 0),
(47, 'A', 'M1', 'Afternoon', 10.02129441, 0),
(47, 'A', 'M1', 'Afternoon', 10.02816584, 0),
(47, 'A', 'M1', 'Afternoon', 10.01503424, 0),
(47, 'A', 'M1', 'Afternoon', 10.01830543, 0),
(48, 'A', 'M3', 'Morning', 9.991327181, 0),
(48, 'A', 'M3', 'Morning', 9.998617341, 0),
(48, 'A', 'M3', 'Morning', 9.993311389, 0),
(48, 'A', 'M3', 'Morning', 10.0413887, 1),
(48, 'A', 'M3', 'Morning', 9.998619611, 0),
(49, 'C', 'M2', 'Afternoon', 10.01668108, 0),
(49, 'C', 'M2', 'Afternoon', 10.01605261, 0),
(49, 'C', 'M2', 'Afternoon', 10.02085919, 0),
(49, 'C', 'M2', 'Afternoon', 9.99036913, 0),
(49, 'C', 'M2', 'Afternoon', 10.02233194, 0),
(50, 'B', 'M1', 'Morning', 9.96194706, 1),
(50, 'B', 'M1', 'Morning', 10.02970436, 0),
(50, 'B', 'M1', 'Morning', 9.965297381, 1),
(50, 'B', 'M1', 'Morning', 9.982223418, 0),
(50, 'B', 'M1', 'Morning', 9.987078309, 0),
(51, 'C', 'M1', 'Afternoon', 10.01682568, 0),
(51, 'C', 'M1', 'Afternoon', 10.0037853, 0),
(51, 'C', 'M1', 'Afternoon', 9.970812989, 0),
(51, 'C', 'M1', 'Afternoon', 9.945933811, 1),
(51, 'C', 'M1', 'Afternoon', 10.00727395, 0),
(52, 'B', 'M3', 'Night', 9.991785012, 0),
(52, 'B', 'M3', 'Night', 9.996436949, 0),
(52, 'B', 'M3', 'Night', 10.0278184, 0),
(52, 'B', 'M3', 'Night', 9.995978562, 0),
(52, 'B', 'M3', 'Night', 9.993453372, 0),
(53, 'C', 'M1', 'Morning', 9.963322175, 1),
(53, 'C', 'M1', 'Morning', 9.967932842, 1),
(53, 'C', 'M1', 'Morning', 10.00601448, 0),
(53, 'C', 'M1', 'Morning', 10.01651358, 0),
(53, 'C', 'M1', 'Morning', 10.02613206, 0),
(54, 'C', 'M3', 'Afternoon', 9.942462201, 1),
(54, 'C', 'M3', 'Afternoon', 9.937469217, 1),
(54, 'C', 'M3', 'Afternoon', 9.965683969, 1),
(54, 'C', 'M3', 'Afternoon', 9.93656229, 1),
(54, 'C', 'M3', 'Afternoon', 9.998612618, 0),
(55, 'C', 'M3', 'Morning', 10.03989218, 1),
(55, 'C', 'M3', 'Morning', 10.01366267, 0),
(55, 'C', 'M3', 'Morning', 10.0154895, 0),
(55, 'C', 'M3', 'Morning', 9.987718216, 0),
(55, 'C', 'M3', 'Morning', 10.05122245, 1),
(56, 'C', 'M3', 'Night', 10.06555351, 1),
(56, 'C', 'M3', 'Night', 10.035715, 1),
(56, 'C', 'M3', 'Night', 10.00177737, 0),
(56, 'C', 'M3', 'Night', 10.01310514, 0),
(56, 'C', 'M3', 'Night', 9.939466613, 1),
(57, 'A', 'M1', 'Morning', 9.973338309, 0),
(57, 'A', 'M1', 'Morning', 9.982130572, 0),
(57, 'A', 'M1', 'Morning', 9.973795368, 0),
(57, 'A', 'M1', 'Morning', 9.933100421, 1),
(57, 'A', 'M1', 'Morning', 9.972666863, 0),
(58, 'C', 'M3', 'Night', 9.972603181, 0),
(58, 'C', 'M3', 'Night', 9.987513632, 0),
(58, 'C', 'M3', 'Night', 9.9684265, 1),
(58, 'C', 'M3', 'Night', 10.00330521, 0),
(58, 'C', 'M3', 'Night', 10.03892895, 1),
(59, 'A', 'M2', 'Morning', 9.976188679, 0),
(59, 'A', 'M2', 'Morning', 9.989905529, 0),
(59, 'A', 'M2', 'Morning', 9.971341289, 0),
(59, 'A', 'M2', 'Morning', 9.98097315, 0),
(59, 'A', 'M2', 'Morning', 9.968088578, 1),
(60, 'B', 'M2', 'Morning', 9.985149232, 0),
(60, 'B', 'M2', 'Morning', 10.02990649, 0),
(60, 'B', 'M2', 'Morning', 9.986676994, 0),
(60, 'B', 'M2', 'Morning', 9.966100367, 1),
(60, 'B', 'M2', 'Morning', 9.991454733, 0),
(61, 'A', 'M1', 'Afternoon', 10.00338464, 0),
(61, 'A', 'M1', 'Afternoon', 10.01866575, 0),
(61, 'A', 'M1', 'Afternoon', 10.00405204, 0),
(61, 'A', 'M1', 'Afternoon', 10.01804648, 0),
(61, 'A', 'M1', 'Afternoon', 9.987065059, 0),
(62, 'B', 'M2', 'Morning', 9.990313047, 0),
(62, 'B', 'M2', 'Morning', 10.01543982, 0),
(62, 'B', 'M2', 'Morning', 10.01902459, 0),
(62, 'B', 'M2', 'Morning', 9.982607916, 0),
(62, 'B', 'M2', 'Morning', 9.972821453, 0),
(63, 'A', 'M3', 'Morning', 9.978078101, 0),
(63, 'A', 'M3', 'Morning', 9.972688704, 0),
(63, 'A', 'M3', 'Morning', 10.00803261, 0),
(63, 'A', 'M3', 'Morning', 9.996903147, 0),
(63, 'A', 'M3', 'Morning', 9.961684832, 1),
(64, 'B', 'M3', 'Morning', 9.98682447, 0),
(64, 'B', 'M3', 'Morning', 10.03437698, 1),
(64, 'B', 'M3', 'Morning', 10.00718104, 0),
(64, 'B', 'M3', 'Morning', 9.978080297, 0),
(64, 'B', 'M3', 'Morning', 10.01853115, 0),
(65, 'C', 'M2', 'Morning', 10.00488426, 0),
(65, 'C', 'M2', 'Morning', 9.982367764, 0),
(65, 'C', 'M2', 'Morning', 10.02257984, 0),
(65, 'C', 'M2', 'Morning', 9.96908926, 1),
(65, 'C', 'M2', 'Morning', 10.01024231, 0),
(66, 'A', 'M1', 'Morning', 9.980497854, 0),
(66, 'A', 'M1', 'Morning', 9.978392483, 0),
(66, 'A', 'M1', 'Morning', 9.972960546, 0),
(66, 'A', 'M1', 'Morning', 9.991210794, 0),
(66, 'A', 'M1', 'Morning', 9.973621359, 0),
(67, 'A', 'M3', 'Afternoon', 10.00415562, 0),
(67, 'A', 'M3', 'Afternoon', 10.01060029, 0),
(67, 'A', 'M3', 'Afternoon', 10.01132535, 0),
(67, 'A', 'M3', 'Afternoon', 9.991373763, 0),
(67, 'A', 'M3', 'Afternoon', 9.995202193, 0),
(68, 'C', 'M2', 'Morning', 10.03995196, 1),
(68, 'C', 'M2', 'Morning', 10.02912911, 0),
(68, 'C', 'M2', 'Morning', 10.00257444, 0),
(68, 'C', 'M2', 'Morning', 9.986095843, 0),
(68, 'C', 'M2', 'Morning', 10.01706218, 0),
(69, 'A', 'M3', 'Morning', 9.993090368, 0),
(69, 'A', 'M3', 'Morning', 9.954352807, 1),
(69, 'A', 'M3', 'Morning', 9.982490495, 0),
(69, 'A', 'M3', 'Morning', 10.03281119, 1),
(69, 'A', 'M3', 'Morning', 9.94491553, 1),
(70, 'A', 'M2', 'Afternoon', 9.992106874, 0),
(70, 'A', 'M2', 'Afternoon', 10.00300135, 0),
(70, 'A', 'M2', 'Afternoon', 10.03559891, 1),
(70, 'A', 'M2', 'Afternoon', 10.01935404, 0),
(70, 'A', 'M2', 'Afternoon', 10.03622379, 1),
(71, 'C', 'M1', 'Morning', 10.03677844, 1),
(71, 'C', 'M1', 'Morning', 9.958514173, 1),
(71, 'C', 'M1', 'Morning', 9.992009158, 0),
(71, 'C', 'M1', 'Morning', 10.01948851, 0),
(71, 'C', 'M1', 'Morning', 10.00388615, 0),
(72, 'B', 'M2', 'Afternoon', 9.9675371, 1),
(72, 'B', 'M2', 'Afternoon', 9.996044147, 0),
(72, 'B', 'M2', 'Afternoon', 9.999437063, 0),
(72, 'B', 'M2', 'Afternoon', 10.00301225, 0),
(72, 'B', 'M2', 'Afternoon', 10.00630093, 0),
(73, 'B', 'M3', 'Morning', 9.977778808, 0),
(73, 'B', 'M3', 'Morning', 10.00624099, 0),
(73, 'B', 'M3', 'Morning', 9.996262823, 0),
(73, 'B', 'M3', 'Morning', 10.00779861, 0),
(73, 'B', 'M3', 'Morning', 9.95724815, 1),
(74, 'B', 'M3', 'Afternoon', 10.01986756, 0),
(74, 'B', 'M3', 'Afternoon', 9.957225823, 1),
(74, 'B', 'M3', 'Afternoon', 10.03396892, 1),
(74, 'B', 'M3', 'Afternoon', 9.96653466, 1),
(74, 'B', 'M3', 'Afternoon', 10.02369166, 0),
(75, 'C', 'M3', 'Afternoon', 10.01529857, 0),
(75, 'C', 'M3', 'Afternoon', 9.995689843, 0),
(75, 'C', 'M3', 'Afternoon', 10.01912499, 0),
(75, 'C', 'M3', 'Afternoon', 10.01669005, 0),
(75, 'C', 'M3', 'Afternoon', 10.0247649, 0),
(76, 'B', 'M3', 'Night', 10.05490559, 1),
(76, 'B', 'M3', 'Night', 10.01312905, 0),
(76, 'B', 'M3', 'Night', 10.01445614, 0),
(76, 'B', 'M3', 'Night', 10.00030451, 0),
(76, 'B', 'M3', 'Night', 9.992494841, 0),
(77, 'A', 'M3', 'Night', 9.8        , 0),
(77, 'A', 'M3', 'Night', 9.8        , 0),
(77, 'A', 'M3', 'Night', 9.8        , 1),
(77, 'A', 'M3', 'Night', 9.8        , 0),
(77, 'A', 'M3', 'Night', 9.8        , 0),
(78, 'A', 'M3', 'Night', 10.01041187, 0),
(78, 'A', 'M3', 'Night', 10.01075647, 0),
(78, 'A', 'M3', 'Night', 10.00825171, 0),
(78, 'A', 'M3', 'Night', 10.03858163, 1),
(78, 'A', 'M3', 'Night', 10.03877577, 1),
(79, 'C', 'M3', 'Night', 10.04368801, 1),
(79, 'C', 'M3', 'Night', 10.06696155, 1),
(79, 'C', 'M3', 'Night', 10.03812847, 1),
(79, 'C', 'M3', 'Night', 10.02167342, 0),
(79, 'C', 'M3', 'Night', 10.03701728, 1),
(80, 'B', 'M3', 'Night', 9.98218204, 0),
(80, 'B', 'M3', 'Night', 10.00682865, 0),
(80, 'B', 'M3', 'Night', 10.00340804, 0),
(80, 'B', 'M3', 'Night', 10.02507241, 0),
(80, 'B', 'M3', 'Night', 10.04349942, 1),
(81, 'A', 'M1', 'Night', 9.98095857, 0),
(81, 'A', 'M1', 'Night', 9.976924756, 0),
(81, 'A', 'M1', 'Night', 10.04149022, 1),
(81, 'A', 'M1', 'Night', 10.00743133, 0),
(81, 'A', 'M1', 'Night', 10.00575557, 0),
(82, 'B', 'M3', 'Night', 9.985655265, 0),
(82, 'B', 'M3', 'Night', 9.987011872, 0),
(82, 'B', 'M3', 'Night', 9.986478134, 0),
(82, 'B', 'M3', 'Night', 9.985592371, 0),
(82, 'B', 'M3', 'Night', 10.01409855, 0),
(83, 'B', 'M3', 'Night', 10.00520404, 0),
(83, 'B', 'M3', 'Night', 9.971452873, 0),
(83, 'B', 'M3', 'Night', 9.966075409, 1),
(83, 'B', 'M3', 'Night', 9.954370943, 1),
(83, 'B', 'M3', 'Night', 9.941515897, 1),
(84, 'A', 'M2', 'Night', 10.01516619, 0),
(84, 'A', 'M2', 'Night', 10.01582838, 0),
(84, 'A', 'M2', 'Night', 9.998248005, 0),
(84, 'A', 'M2', 'Night', 9.990148242, 0),
(84, 'A', 'M2', 'Night', 10.00067096, 0),
(85, 'C', 'M3', 'Afternoon', 9.973517297, 0),
(85, 'C', 'M3', 'Afternoon', 10.01598898, 0),
(85, 'C', 'M3', 'Afternoon', 9.99675592, 0),
(85, 'C', 'M3', 'Afternoon', 10.0215094, 0),
(85, 'C', 'M3', 'Afternoon', 9.963002093, 1),
(86, 'B', 'M2', 'Afternoon', 9.995075504, 0),
(86, 'B', 'M2', 'Afternoon', 9.968759906, 1),
(86, 'B', 'M2', 'Afternoon', 9.981451404, 0),
(86, 'B', 'M2', 'Afternoon', 9.9847561, 0),
(86, 'B', 'M2', 'Afternoon', 9.987907237, 0),
(87, 'A', 'M1', 'Afternoon', 10.00174745, 0),
(87, 'A', 'M1', 'Afternoon', 9.985964964, 0),
(87, 'A', 'M1', 'Afternoon', 9.991362577, 0),
(87, 'A', 'M1', 'Afternoon', 10.03966038, 1),
(87, 'A', 'M1', 'Afternoon', 9.966119755, 1),
(88, 'B', 'M1', 'Afternoon', 10.0398826, 1),
(88, 'B', 'M1', 'Afternoon', 9.972828642, 0),
(88, 'B', 'M1', 'Afternoon', 10.05944287, 1),
(88, 'B', 'M1', 'Afternoon', 10.03535656, 1),
(88, 'B', 'M1', 'Afternoon', 10.00316374, 0),
(89, 'A', 'M1', 'Night', 10.00830713, 0),
(89, 'A', 'M1', 'Night', 10.01441631, 0),
(89, 'A', 'M1', 'Night', 9.97122105, 0),
(89, 'A', 'M1', 'Night', 9.990514011, 0),
(89, 'A', 'M1', 'Night', 9.996360034, 0),
(90, 'B', 'M3', 'Morning', 9.974846579, 0),
(90, 'B', 'M3', 'Morning', 10.00292261, 0),
(90, 'B', 'M3', 'Morning', 10.00585246, 0),
(90, 'B', 'M3', 'Morning', 10.0697605, 1),
(90, 'B', 'M3', 'Morning', 10.02131316, 0),
(91, 'A', 'M3', 'Morning', 9.986441988, 0),
(91, 'A', 'M3', 'Morning', 10.00049353, 0),
(91, 'A', 'M3', 'Morning', 10.00292284, 0),
(91, 'A', 'M3', 'Morning', 10.02378444, 0),
(91, 'A', 'M3', 'Morning', 9.988698887, 0),
(92, 'B', 'M3', 'Morning', 9.974712231, 0),
(92, 'B', 'M3', 'Morning', 9.983794131, 0),
(92, 'B', 'M3', 'Morning', 9.990720411, 0),
(92, 'B', 'M3', 'Morning', 10.02312592, 0),
(92, 'B', 'M3', 'Morning', 10.01126125, 0),
(93, 'A', 'M3', 'Morning', 10.02235498, 0),
(93, 'A', 'M3', 'Morning', 10.01550246, 0),
(93, 'A', 'M3', 'Morning', 10.01019354, 0),
(93, 'A', 'M3', 'Morning', 9.974981598, 0),
(93, 'A', 'M3', 'Morning', 10.02773794, 0),
(94, 'C', 'M2', 'Night', 9.997860911, 0),
(94, 'C', 'M2', 'Night', 9.931835535, 1),
(94, 'C', 'M2', 'Night', 10.03806836, 1),
(94, 'C', 'M2', 'Night', 9.903783033, 1),
(94, 'C', 'M2', 'Night', 10.03602654, 1),
(95, 'C', 'M2', 'Afternoon', 9.99982398, 0),
(95, 'C', 'M2', 'Afternoon', 10.00036397, 0),
(95, 'C', 'M2', 'Afternoon', 9.995445545, 0),
(95, 'C', 'M2', 'Afternoon', 9.967988755, 1),
(95, 'C', 'M2', 'Afternoon', 9.992245582, 0),
(96, 'B', 'M3', 'Morning', 9.970413659, 0),
(96, 'B', 'M3', 'Morning', 9.977653318, 0),
(96, 'B', 'M3', 'Morning', 10.01948231, 0),
(96, 'B', 'M3', 'Morning', 10.00803434, 0),
(96, 'B', 'M3', 'Morning', 10.00093736, 0),
(97, 'B', 'M2', 'Morning', 9.97633751, 0),
(97, 'B', 'M2', 'Morning', 9.99582051, 0),
(97, 'B', 'M2', 'Morning', 9.972336149, 0),
(97, 'B', 'M2', 'Morning', 10.00006866, 0),
(97, 'B', 'M2', 'Morning', 9.957851933, 1),
(98, 'A', 'M2', 'Afternoon', 9.997863572, 0),
(98, 'A', 'M2', 'Afternoon', 9.983095186, 0),
(98, 'A', 'M2', 'Afternoon', 9.97865531, 0),
(98, 'A', 'M2', 'Afternoon', 10.00980702, 0),
(98, 'A', 'M2', 'Afternoon', 9.973248581, 0),
(99, 'B', 'M1', 'Morning', 10.03709772, 1),
(99, 'B', 'M1', 'Morning', 10.03494612, 1),
(99, 'B', 'M1', 'Morning', 10.06427275, 1),
(99, 'B', 'M1', 'Morning', 10.03303733, 1),
(99, 'B', 'M1', 'Morning', 10.07050999, 1),
(100, 'B', 'M2', 'Night', 10.02077675, 0),
(100, 'B', 'M2', 'Night', 10.00123466, 0),
(100, 'B', 'M2', 'Night', 10.00527109, 0),
(100, 'B', 'M2', 'Night', 10.00744495, 0),
(100, 'B', 'M2', 'Night', 9.999283635, 0),
(101, 'C', 'M3', 'Afternoon', 9.976870572, 0),
(101, 'C', 'M3', 'Afternoon', 10.00520808, 0),
(101, 'C', 'M3', 'Afternoon', 9.96486205, 1),
(101, 'C', 'M3', 'Afternoon', 10.00492403, 0),
(101, 'C', 'M3', 'Afternoon', 9.99364055, 0),
(102, 'A', 'M2', 'Night', 9.994399086, 0),
(102, 'A', 'M2', 'Night', 9.967613182, 1),
(102, 'A', 'M2', 'Night', 9.97950705, 0),
(102, 'A', 'M2', 'Night', 9.97825355, 0),
(102, 'A', 'M2', 'Night', 9.967959596, 1),
(103, 'A', 'M1', 'Night', 10.03188788, 1),
(103, 'A', 'M1', 'Night', 10.00554409, 0),
(103, 'A', 'M1', 'Night', 9.973940349, 0),
(103, 'A', 'M1', 'Night', 9.990179798, 0),
(103, 'A', 'M1', 'Night', 10.02474707, 0),
(104, 'B', 'M3', 'Night', 10.03001247, 1),
(104, 'B', 'M3', 'Night', 10.0250753, 0),
(104, 'B', 'M3', 'Night', 10.01758046, 0),
(104, 'B', 'M3', 'Night', 10.00699354, 0),
(104, 'B', 'M3', 'Night', 9.975177638, 0),
(105, 'C', 'M3', 'Afternoon', 9.994524401, 0),
(105, 'C', 'M3', 'Afternoon', 10.00424362, 0),
(105, 'C', 'M3', 'Afternoon', 9.991485928, 0),
(105, 'C', 'M3', 'Afternoon', 9.963124324, 1),
(105, 'C', 'M3', 'Afternoon', 9.99658408, 0),
(106, 'C', 'M1', 'Night', 9.999235063, 0),
(106, 'C', 'M1', 'Night', 10.04621703, 1),
(106, 'C', 'M1', 'Night', 10.00388504, 0),
(106, 'C', 'M1', 'Night', 9.99040884, 0),
(106, 'C', 'M1', 'Night', 10.03772771, 1),
(107, 'B', 'M3', 'Morning', 10.00916977, 0),
(107, 'B', 'M3', 'Morning', 9.96377347, 1),
(107, 'B', 'M3', 'Morning', 10.03572653, 1),
(107, 'B', 'M3', 'Morning', 9.982482122, 0),
(107, 'B', 'M3', 'Morning', 10.00115529, 0),
(108, 'B', 'M3', 'Night', 9.988402304, 0),
(108, 'B', 'M3', 'Night', 10.02613648, 0),
(108, 'B', 'M3', 'Night', 10.00112802, 0),
(108, 'B', 'M3', 'Night', 10.01783382, 0),
(108, 'B', 'M3', 'Night', 9.967485718, 1),
(109, 'A', 'M2', 'Afternoon', 9.936156125, 1),
(109, 'A', 'M2', 'Afternoon', 9.974835125, 0),
(109, 'A', 'M2', 'Afternoon', 9.959861737, 1),
(109, 'A', 'M2', 'Afternoon', 10.03554253, 1),
(109, 'A', 'M2', 'Afternoon', 9.97058102, 0),
(110, 'C', 'M1', 'Afternoon', 9.982714541, 0),
(110, 'C', 'M1', 'Afternoon', 10.03075983, 1),
(110, 'C', 'M1', 'Afternoon', 9.999374763, 0),
(110, 'C', 'M1', 'Afternoon', 9.99582796, 0),
(110, 'C', 'M1', 'Afternoon', 9.993311785, 0),
(111, 'B', 'M2', 'Afternoon', 9.946846909, 1),
(111, 'B', 'M2', 'Afternoon', 9.949583264, 1),
(111, 'B', 'M2', 'Afternoon', 9.98464729, 0),
(111, 'B', 'M2', 'Afternoon', 9.967680364, 1),
(111, 'B', 'M2', 'Afternoon', 9.954483129, 1),
(112, 'C', 'M2', 'Night', 10.00044467, 0),
(112, 'C', 'M2', 'Night', 10.03837948, 1),
(112, 'C', 'M2', 'Night', 9.986937975, 0),
(112, 'C', 'M2', 'Night', 10.02017843, 0),
(112, 'C', 'M2', 'Night', 9.98091385, 0),
(113, 'B', 'M2', 'Night', 9.980258507, 0),
(113, 'B', 'M2', 'Night', 10.00334453, 0),
(113, 'B', 'M2', 'Night', 9.979779585, 0),
(113, 'B', 'M2', 'Night', 9.982317614, 0),
(113, 'B', 'M2', 'Night', 9.988874697, 0),
(114, 'C', 'M3', 'Morning', 10.04691789, 1),
(114, 'C', 'M3', 'Morning', 10.00354533, 0),
(114, 'C', 'M3', 'Morning', 10.04107298, 1),
(114, 'C', 'M3', 'Morning', 10.00090917, 0),
(114, 'C', 'M3', 'Morning', 10.10087291, 1),
(115, 'A', 'M3', 'Night', 9.975349438, 0),
(115, 'A', 'M3', 'Night', 10.03656937, 1),
(115, 'A', 'M3', 'Night', 10.0081786, 0),
(115, 'A', 'M3', 'Night', 9.972619637, 0),
(115, 'A', 'M3', 'Night', 9.992715796, 0),
(116, 'A', 'M3', 'Night', 10.02982468, 0),
(116, 'A', 'M3', 'Night', 9.991141357, 0),
(116, 'A', 'M3', 'Night', 10.01024719, 0),
(116, 'A', 'M3', 'Night', 9.973181547, 0),
(116, 'A', 'M3', 'Night', 9.983005681, 0),
(117, 'C', 'M1', 'Afternoon', 10.00904357, 0),
(117, 'C', 'M1', 'Afternoon', 10.00913145, 0),
(117, 'C', 'M1', 'Afternoon', 10.02887548, 0),
(117, 'C', 'M1', 'Afternoon', 10.01129341, 0),
(117, 'C', 'M1', 'Afternoon', 10.02552196, 0),
(118, 'B', 'M3', 'Morning', 10.00157308, 0),
(118, 'B', 'M3', 'Morning', 10.02057202, 0),
(118, 'B', 'M3', 'Morning', 10.03093299, 1),
(118, 'B', 'M3', 'Morning', 10.02516857, 0),
(118, 'B', 'M3', 'Morning', 10.0189044, 0),
(119, 'A', 'M1', 'Afternoon', 9.992176747, 0),
(119, 'A', 'M1', 'Afternoon', 10.00866413, 0),
(119, 'A', 'M1', 'Afternoon', 10.00159359, 0),
(119, 'A', 'M1', 'Afternoon', 10.00393465, 0),
(119, 'A', 'M1', 'Afternoon', 10.01588821, 0),
(120, 'C', 'M3', 'Afternoon', 9.97777397, 0),
(120, 'C', 'M3', 'Afternoon', 9.980654343, 0),
(120, 'C', 'M3', 'Afternoon', 10.00434426, 0),
(120, 'C', 'M3', 'Afternoon', 10.0028102, 0),
(120, 'C', 'M3', 'Afternoon', 10.00245339, 0);

select * from metal_rods
drop table metal_rods

--------------------Top 5 Batches With Highest Defects--------------
SELECT TOP 5 BatchID, SUM(Defective) AS TotalDefects
FROM metal_rods
GROUP BY BatchID
ORDER BY TotalDefects DESC;

----------Top 5 Batches With Highest Proportion Defect--------

SELECT TOP 5 
    BatchID,
    SUM(Defective) AS Defects,
    COUNT(*) AS TotalUnits,
    CAST(SUM(Defective) AS FLOAT) / COUNT(*) AS DefectRate
FROM metal_rods
GROUP BY BatchID
ORDER BY DefectRate DESC;

-------Summary Stats (Cards)

SELECT 
    COUNT(DISTINCT BatchID) AS TotalBatches,
    SUM(Defective) AS TotalDefects,
    AVG(CAST(Defective AS FLOAT)) AS AvgDefectRate
FROM metal_rods;

------------------Batch Size Variation-----------
SELECT 
    BatchID,
    COUNT(*) AS UnitsTested
FROM metal_rods
GROUP BY BatchID
ORDER BY UnitsTested DESC;

-----------Variation by Machine/Shift/Operator
SELECT Machine , 
       SUM(Defective) AS TotalDefects,
       CAST(SUM(Defective) AS FLOAT) / COUNT(*) AS DefectRate
FROM metal_rods
GROUP BY Machine
ORDER BY DefectRate DESC;


SELECT Shift_ , 
       SUM(Defective) AS TotalDefects,
       CAST(SUM(Defective) AS FLOAT) / COUNT(*) AS DefectRate
FROM metal_rods
GROUP BY Shift_
ORDER BY DefectRate DESC;

SELECT operator , 
       SUM(Defective) AS TotalDefects,
       CAST(SUM(Defective) AS FLOAT) / COUNT(*) AS DefectRate
FROM metal_rods
GROUP BY operator
ORDER BY DefectRate DESC;



------------------Drill-Down Table (Master Data Table)

SELECT BatchID, Diameter_mm, Defective
FROM metal_rods;


